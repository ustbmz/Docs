## 步骤一 : 申请证书

安装 ACME 获取证书 

Github  https://github.com/acmesh-official/acme.sh

```shell
$ git clone https://github.com/acmesh-official/acme.sh.git
$ cd ./acme.sh
$ ./acme.sh --install -m cnmz@msn.com
```

## 使用Dnsapi  (腾讯云)

* DNSPod 只能使用 dnspod token


> 官方说明 https://github.com/acmesh-official/acme.sh/wiki/dnsapi
>
> DSNPod Token https://console.dnspod.cn/account/token/token#

```shell
## 腾讯云域名DNS配置
## export CF_Key="sdfsdfsdfljlbjkljlkjsdfoiwje"
## export CF_Email="xxxx@sss.com"

$ export DP_Id="270900"
$ export DP_Key="6eb6daa99d13bcf01f321aa79284deeb"

$ acme.sh --issue --dns dns_dp -d ustbmz.cn -d *.ustbmz.cn

## 阿里云域名DNS配置

acme.sh --register-account --accountemail "cnmz@msn.com" \
--accountkeylength ec-256 \
--dns dns_ali \
--debug

acme.sh --issue --dns dns_ali -d ustbmz.cn -d *.ustbmz.cn
```



![image-20250128100837012](https://s2.loli.net/2025/02/17/NI2lcxW7K1CoEn5.png)

## 配置  Nginx

> 生成nginx 密钥 ,  提高 nginx 安全性

```shell
# 创建 keys存放文件夹
$ mkdir -p /home/keys
# 生成nginx密钥
$ openssl dhparam -out /home/keys/dhparam.pem 2048
```


> 证书安装至指定目录 
```
acme.sh --install-cert -d ustbmz.cn \
--key-file       /home/keys/key.pem  \
--fullchain-file /home/keys//cert.pem \
--reloadcmd     " systemctl restart nginx"
```

```
acme.sh --install-cert -d ustbmz.cn \
--key-file /etc/nginx/ssl/ustbmz.cn.key \
--fullchain-file /etc/nginx/ssl/ustbmz.cn.crt \
--reloadcmd "systemctl reload nginx"
```



Nginx 配置

```
server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;

    # 重定向 HTTP 到 HTTPS
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name ustbmz.cn ustbmz.cn;

    # SSL 配置
    ssl_certificate /etc/nginx/ssl/ustbmz.cn.crt;
    ssl_certificate_key /etc/nginx/ssl/ustbmz.cn.key;

    # 网站根目录设置
    root /usr/share/nginx/html;
    index index.html index.htm;

    # 日志
    access_log /var/log/nginx/yourdomain.access.log;
    error_log /var/log/nginx/yourdomain.error.log;

    # 处理请求
    location / {
        try_files $uri $uri/ =404;
    }
}

```

## 使用PM2 启动后端 Server

```

ln -s /opt/nodejs/lib/node_modules/pm2/bin/pm2  /usr/local/bin
```

